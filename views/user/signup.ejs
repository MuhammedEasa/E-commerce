<%-include('header') -%>

<!-- Start Header Area -->
<header class="header_area sticky-header">
  <div class="main_menu">
    <nav class="navbar navbar-expand-lg navbar-light main_box">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <a class="navbar-brand logo_h" href="/"
          ><img src="img/logo.png" alt="E-Cart"
        /></a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div
          class="collapse navbar-collapse offset"
          id="navbarSupportedContent"
        >
          <ul class="nav navbar-nav menu_nav ml-auto">
          
            <li class="nav-item">
              <a href="/login" class="nav-link" role="button">Login</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>
<!-- End Header Area -->

<!-- Start Banner Area -->
<section class="banner-area organic-breadcrumb">
  <div class="container">
    <div
      class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end"
    >
      <div class="col-first">
        <h1>Login/Register</h1>
        <nav class="d-flex align-items-center">
          <a href="#">Home<span class="lnr lnr-arrow-right"></span></a>
          <a href="#">Login/Register</a>
        </nav>
      </div>
    </div>
  </div>
</section>
<!-- End Banner Area -->
<div class="container">
  <div class="col-md-4 mx-auto">
    <% if (typeof message !== 'undefined') { %>
    <div class="alert alert-success text-center"><%= message %></div>
    <% } %> <% if (typeof loginmessage !== 'undefined') { %>
    <div class="alert alert-danger text-center"><%= loginmessage %></div>
    <% } %>
  </div>
</div>

<!--================Login Box Area =================-->
<section class="login_box_area section_gap">
  <div class="container">
    <div class="row">
      <div class="col-lg-6">
        <div class="login_box_img">
          <img class="img-fluid" src="img/login1.jpg" alt="signup-login" />
          <div class="hover">
            <h4>Already Have an Account ?</h4>
            <p>
              Welcome to our E-Cart where you can find a diverse selection of
              products, including laptops, headphones, and stylish shoes. Shop
              now!
            </p>
            <a class="primary-btn" href="/login">Login</a>
          </div>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="login_form_inner">
          <h3>Sign Up to enter</h3>
            <form class="row login_form" action="/signup" method="post">
              <div class="col-md-12 form-group">
                <input
                  type="text"
                  class="form-control"
                  id="username"
                  name="username"
                  placeholder="Username"
                  onfocus="this.placeholder = ''"
                  onblur="this.placeholder = 'Username'"
                />
              </div>
            <div class="col-md-12 form-group">
              <input
                type="email"
                class="form-control"
                id="email"
                name="email"
                placeholder="email"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'email'"
              />
            </div>
            <div class="col-md-12 form-group">
              <input
                  type="number"
                  class="form-control"
                  id="phoneNumber"
                  name="phoneNumber"
                  maxlength="10"
                  minlength="10"
                  placeholder="Phone Number"
                  onfocus="this.placeholder = ''"
                  onblur="this.placeholder = 'Phone Number'"
              />
          </div>
            <div class="col-md-12 form-group">
              <input
                type="password"
                class="form-control"
                id="password"
                name="password"
                placeholder="Password"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'Password'"
              />
            </div>
            <div class="col-md-12 form-group">
                <input
                    type="text"
                    class="form-control"
                    id="referralCode"
                    name="referralCode"
                    placeholder="Referral Code (optional)"
                    onfocus="this.placeholder = ''"
                    onblur="this.placeholder = 'Referral Code (optional)'"
                />
            </div>
            <div id="messageContainer" class="alert alert-success" style="margin-top: 5px; padding: 5px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; color: #155724; font-size: 14px; text-align: center; display: none;"></div>
            <div class="col-md-12 form-group">
              <button type="submit" value="Sign Up" class="primary-btn">
                Sign Up
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</section>


<!--================End Login Box Area =================-->

<!-- start footer Area -->
<footer class="footer-area section_gap">
  <div class="container">
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div class="single-footer-widget">
          <h6>About Us</h6>
          <p>
            Discover endless shopping possibilities at E-Cart. We offer quality
            shoes, laptops, headphones, and more, ensuring convenience and
            satisfaction.
          </p>
        </div>
      </div>

      <div class="col-lg-4 col-md-6 col-sm-6">
        <div class="single-footer-widget">
          <h6>Newsletter</h6>
          <p>Stay update with our latest</p>
          <div class="" id="mc_embed_signup">
            <form
              target="_blank"
              novalidate="true"
              action="#"
              method="get"
              class="form-inline"
            >
              <div class="d-flex flex-row">
                <input
                  class="form-control"
                  name="EMAIL"
                  placeholder="Enter Email"
                  onfocus="this.placeholder = ''"
                  onblur="this.placeholder = 'Enter Email '"
                  required=""
                  type="email"
                />

                <button class="click-btn btn btn-default">
                  <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                </button>
                <div style="position: absolute; left: -5000px">
                  <input
                    name="b_36c4fd991d266f23781ded980_aefe40901a"
                    tabindex="-1"
                    value=""
                    type="text"
                  />
                </div>

                <!-- <div class="col-lg-4 col-md-4">
                                                <button class="bb-btn btn"><span class="lnr lnr-arrow-right"></span></button>
                                            </div>  -->
              </div>
              <div class="info"></div>
            </form>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-md-6 col-sm-6">
        <div class="single-footer-widget mail-chimp">
          <h6 class="mb-20">Customer Assistance</h6>
          <ul class="instafeed d-flex flex-wrap">
            <li><p>Help</p></li>
            <li><p>Chat</p></li>
            <li><p>Support</p></li>
          </ul>
        </div>
      </div>

      <div class="col-lg-2 col-md-6 col-sm-6">
        <div class="single-footer-widget">
          <h6>Follow Us</h6>
          <p>Let us be social</p>
          <div class="footer-social d-flex align-items-center">
            <a href="https://www.facebook.com/muhammedeasa.muhammedeasa.1/"><i class="fa fa-facebook"></i></a>
            <a href="https://twitter.com/Pavamgamer"><i class="fa fa-twitter"></i></a>
            <a href="https://www.instagram.com/al_hafiz_muhammed_easa?igshid=NGVhN2U2NjQ0Yg=="><i class="fa fa-instagram"></i></a>
            <a href="https://www.linkedin.com/feed/"><i class="fa fa-linkedin"></i></a>
          </div>
        </div>
      </div>
    </div>
    <div
      class="footer-bottom d-flex justify-content-center align-items-center flex-wrap"
    >
      <p class="footer-text m-0">
        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
        Copyright &copy;
        <script>
          document.write(new Date().getFullYear());
        </script>
        All rights reserved | This template is made with
        <i class="fa fa-heart-o" aria-hidden="true"></i> by
        <a href="https://colorlib.com" target="_blank">Colorlib</a>
        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
      </p>
    </div>
  </div>
</footer>
<!-- End footer Area -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector(".login_form");
    form.addEventListener("submit", function (event) {
      const usernameInput = document.getElementById("username");
      const emailInput = document.getElementById("email");
      const phoneNumberInput = document.getElementById("phoneNumber");
      const passwordInput = document.getElementById("password");

      // Remove existing error messages
      removeErrorMessage(usernameInput);
      removeErrorMessage(emailInput);
      removeErrorMessage(phoneNumberInput);
      removeErrorMessage(passwordInput);

      if (!usernameInput.value.trim()) {
        event.preventDefault(); // Prevent form submission
        displayErrorMessage(usernameInput, "Please enter a valid username.");
      }

      if (!emailInput.value.trim()) {
        event.preventDefault(); // Prevent form submission
        displayErrorMessage(emailInput, "Please enter a valid email.");
      }

      if (!phoneNumberInput.value.trim()) {
        event.preventDefault(); // Prevent form submission
        displayErrorMessage(phoneNumberInput, "Please enter a valid phone number.");
      }

      if (!passwordInput.value.trim()) {
        event.preventDefault(); // Prevent form submission
        displayErrorMessage(passwordInput, "Please enter a valid password.");
      }
    });

    function displayErrorMessage(inputElement, message) {
      // Display error message
      const errorMessage = document.createElement("p");
      errorMessage.textContent = message;
      errorMessage.style.color = "red";
      errorMessage.classList.add("error-message");

      // Insert error message below the input field
      const parentElement = inputElement.parentElement;
      parentElement.insertBefore(errorMessage, inputElement.nextSibling);
    }

    function removeErrorMessage(inputElement) {
      // Remove existing error messages
      const parentElement = inputElement.parentElement;
      const existingErrorMessage = parentElement.querySelector(".error-message");

      if (existingErrorMessage) {
        parentElement.removeChild(existingErrorMessage);
      }
    }
  });
</script>
<script>
 document.addEventListener('DOMContentLoaded', () => {
  const signupForm = document.querySelector(".login_form");
  const messageContainer = document.getElementById('messageContainer');

  signupForm.addEventListener('submit', async (event) => {
    event.preventDefault();
    
    // Use signupForm instead of this
    const formData = new FormData(signupForm);
    
    try {
      const response = await fetch('/signup', {
        method: 'POST',
        body: new URLSearchParams(formData),
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
      });

      const result = await response.json();
      console.log(result);

      // Display the message
      messageContainer.style.display = 'block';

      if (result.success) {
        // Redirect to the specified URL
        console.log(result);
        window.location.href = result.redirect;
      } else {
        messageContainer.innerHTML = `<p>${result.message}</p>`;
        setTimeout(() => {
          messageContainer.innerHTML = '';
          messageContainer.style.display = 'none';
        }, 2000);
      }
    } catch (error) {
      console.error('Error:', error);
    }
  });
});

</script>


<%-include('footer') -%>
